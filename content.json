{"meta":{"title":"Yan's Blog","subtitle":"","description":"","author":"OVYVO","url":"https://ovyvo.github.io/yanblog.github.io","root":"/yanblog.github.io/"},"pages":[{"title":"å…³äº","date":"2022-07-31T11:43:24.895Z","updated":"2022-07-31T11:43:24.895Z","comments":false,"path":"about/index.html","permalink":"https://ovyvo.github.io/yanblog.github.io/about/index.html","excerpt":"","text":"æ²ªæ¼‚å‰ç«¯æ”»åŸç‹® 123456789101112131415161718192021&#123; name: &#x27;è‹¥æ‹™&#x27; age: 25, gender: &#x27;ç”·&#x27;, profession: &#x27;Web Developer&#x27;, experience: &#x27;2&#x27;, address: &#x27;ä¸Šæµ·å¸‚æ™®é™€åŒº&#x27;, education: &#x27;æœ¬ç§‘&#x27;, github: &#x27;https://github.com/OVYVO&#x27;, email: &#x27;vue12306@163.com&#x27;, description: &#x27;é†‰åä¸çŸ¥å¤©åœ¨æ°´ï¼Œæ»¡èˆ¹æ¸…æ¢¦å‹æ˜Ÿæ²³&#x27;, skills: [ [&#x27;Html&#x27;, &#x27;Javascript&#x27;, &#x27;CSS&#x27;, &#x27;ES6&#x27;, &#x27;Node&#x27;], [&#x27;Vue&#x27;,&#x27;Nuxt&#x27;,&#x27;Taro&#x27;,&#x27;React&#x27;], [&#x27;AntDesign&#x27;, &#x27;Element&#x27;, &#x27;Vant&#x27;], [&#x27;Webpack&#x27;, &#x27;Gulp&#x27;, &#x27;vite&#x27;], [&#x27;Less&#x27;,&#x27;Sass&#x27;], [&#x27;Git&#x27; ] ]&#125;"},{"title":"ä¹¦å•","date":"2022-07-31T11:43:24.895Z","updated":"2022-07-31T11:43:24.895Z","comments":false,"path":"books/index.html","permalink":"https://ovyvo.github.io/yanblog.github.io/books/index.html","excerpt":"","text":""},{"title":"çº¿ä¸Šé¡¹ç›®åœ°å€","date":"2022-07-31T11:43:24.895Z","updated":"2022-07-31T11:43:24.895Z","comments":false,"path":"links/index.html","permalink":"https://ovyvo.github.io/yanblog.github.io/links/index.html","excerpt":"","text":""},{"title":"ä¸ªäººé¡¹ç›®","date":"2022-07-31T11:43:24.895Z","updated":"2022-07-31T11:43:24.895Z","comments":false,"path":"repository/index.html","permalink":"https://ovyvo.github.io/yanblog.github.io/repository/index.html","excerpt":"","text":""},{"title":"åˆ†ç±»","date":"2022-07-31T11:43:24.895Z","updated":"2022-07-31T11:43:24.895Z","comments":false,"path":"categories/index.html","permalink":"https://ovyvo.github.io/yanblog.github.io/categories/index.html","excerpt":"","text":""},{"title":"æ ‡ç­¾","date":"2022-07-31T11:43:24.896Z","updated":"2022-07-31T11:43:24.896Z","comments":false,"path":"tags/index.html","permalink":"https://ovyvo.github.io/yanblog.github.io/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"H5åœ¨IOSå¾®ä¿¡webviewä¸­æ— æ³•æ ¡éªŒè§†é¢‘æ—¶é•¿é—®é¢˜","slug":"blog5","date":"2022-07-30T16:00:00.000Z","updated":"2022-07-31T11:56:48.542Z","comments":false,"path":"2022/07/31/blog5/","link":"","permalink":"https://ovyvo.github.io/yanblog.github.io/2022/07/31/blog5/","excerpt":"","text":"å› ä¸šåŠ¡éœ€æ±‚éœ€è¦ä¸€ä¸ªå›¾ç‰‡è§†é¢‘æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ï¼Œéœ€æ”¯æŒä¸»æµæµè§ˆå™¨åŠå¾®ä¿¡é’‰é’‰å†…ç½®æµè§ˆå™¨ï¼Œé‚è€ƒè™‘ç”¨ä¸€ä¸ªç®€å•çš„H5é¡µé¢åšä¸Šä¼ å®¢æˆ·ç«¯ã€‚è§†é¢‘ä¸Šä¼ å› ä¸ºè¦æ§åˆ¶è§†é¢‘é•¿åº¦ï¼Œåœ¨å…¶ä»–æµè§ˆå™¨ä¸­éƒ½æ ¡éªŒé€šè¿‡ï¼Œä½†æ˜¯åœ¨å¾®ä¿¡ä¸­å´å‡ºäº†é—®é¢˜ 123456789101112131415161718192021222324const beforeRead = (file)=&gt; &#123; return new Promise((resolve,reject)=&gt;&#123; if(props.type == &#x27;video&#x27;)&#123; let url = URL.createObjectURL(file) let audioElement = new Audio(url) audioElement.addEventListener(&quot;loadedmetadata&quot;, ()=&gt;&#123; let audioDuration = audioElement.duration; if(audioDuration&gt;60)&#123; Toast(`ä»…æ”¯æŒä¸Šä¼ 1åˆ†é’Ÿæ—¶é•¿ä»¥å†…è§†é¢‘`) reject() &#125;else&#123; resolve(file) &#125; &#125;) &#125;else&#123; if (![&#x27;image/jpeg&#x27;,&#x27;image/png&#x27;].includes(file.type)) &#123; Toast(&#x27;æ‰€é€‰æ–‡ä»¶æ ¼å¼ä¸æ”¯æŒ&#x27;); reject() &#125;else&#123; resolve(file) &#125; &#125; &#125;) &#125; é—®é¢˜åŸå› ï¼šIOSå¾®ä¿¡æµè§ˆå™¨éœ€è¦æ’­æ”¾è§†é¢‘æ‰èƒ½é€šè¿‡ç›‘å¬loadedmetadataäº‹ä»¶è·å–è§†é¢‘é•¿åº¦ï¼Œä»¥ä¸‹æ˜¯è§£å†³åŠæ³•ï¼š 12345678910111213141516171819202122232425262728const beforeRead = (file)=&gt; &#123; return new Promise((resolve,reject)=&gt;&#123; if(props.type == &#x27;video&#x27;)&#123; let url = URL.createObjectURL(file) let audioElement = new Audio(url) audioElement.muted = true audioElement.play().then(()=&gt;audioElement.pause()) audioElement.addEventListener(&quot;loadedmetadata&quot;, ()=&gt;&#123; let audioDuration = audioElement.duration; if(audioDuration&gt;60)&#123; audioElement.muted = false Toast(`ä»…æ”¯æŒä¸Šä¼ 1åˆ†é’Ÿæ—¶é•¿ä»¥å†…è§†é¢‘`) reject() &#125;else&#123; audioElement.muted = false resolve(file) &#125; &#125;) &#125;else&#123; if (![&#x27;image/jpeg&#x27;,&#x27;image/png&#x27;].includes(file.type)) &#123; Toast(&#x27;æ‰€é€‰æ–‡ä»¶æ ¼å¼ä¸æ”¯æŒ&#x27;); reject() &#125;else&#123; resolve(file) &#125; &#125; &#125;) &#125; H5é¡µé¢vue3.0+vantï¼Œå‚è§uploadç»„ä»¶ä¸å†èµ˜è¿°ï¼","categories":[{"name":"vue","slug":"vue","permalink":"https://ovyvo.github.io/yanblog.github.io/categories/vue/"}],"tags":[{"name":"vue-3","slug":"vue-3","permalink":"https://ovyvo.github.io/yanblog.github.io/tags/vue-3/"}]},{"title":"Taroå°ç¨‹åºæ·»åŠ Echartsä»£ç åŒ…è¿‡å¤§è§£å†³åŠæ³•","slug":"blog4","date":"2021-10-19T00:00:00.000Z","updated":"2022-07-31T11:43:24.895Z","comments":false,"path":"2021/10/19/blog4/","link":"","permalink":"https://ovyvo.github.io/yanblog.github.io/2021/10/19/blog4/","excerpt":"","text":"ä¸Šå›ä¹¦è¯´åˆ°å¦‚ä½•åœ¨Taroå°ç¨‹åºä¸­å¼•å…¥Echartså›¾è¡¨ã€‚å¦‚æœå°ç¨‹åºä¸»åŒ…ä»£ç ä½“é‡ä¸å¤šå¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œä½†æ˜¯å¦‚æœå°ç¨‹åºä»£ç ä½“é‡å¤§ï¼Œç¨ä¸ç•™ç¥å°±ä¼šå¯¼è‡´ä¸»åŒ…ä»£ç è¶…è¿‡2Mï¼Œæ— æ³•é¢„è§ˆä¹Ÿæ— æ³•çœŸæœºè°ƒè¯•ã€‚æœ¬æ–‡ç€é‡ä»‹ç»ä¸€ä¸‹Taroå¼•å…¥Echartsåˆ†åŒ…æ“ä½œä»¥åŠæ³¨æ„äº‹é¡¹ã€‚ å‰æ–‡é“¾æ¥ï¼Œå®Œæ•´æµç¨‹å¯ä»¥è‡ªè¡ŒæŸ¥é˜… taroå°ç¨‹åºæ·»åŠ Echartså®è·µåˆ†åŒ…æ“ä½œï¼š å°†ä¸echartsç»„ä»¶ç›¸å…³éƒ½ç§»åˆ°åˆ†åŒ…ä¸­ï¼Œç»“æ„ç›®å½•å¦‚ä¸‹ é…ç½®app.config.js 12345678910...subpackages: [ &#123; root: &quot;subpages&quot;, pages: [ &#x27;test/index&#x27; ] &#125; ],... é…ç½®config/index å¯¼è‡´åŒ…æ–‡ä»¶è¿‡å¤§çš„â€œç½ªé­ç¥¸é¦–â€å°±æ˜¯ec-canvasæ–‡ä»¶å¤¹ä¸‹çš„echarts.jsæ–‡ä»¶ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦è§£å†³çš„é—®é¢˜æ˜¯ï¼Œåˆ†åŒ…ä½¿ç”¨Echartsç»„ä»¶ä¸èƒ½å°†echarts.jsæ‰“åŒ…åˆ°ä¸»åŒ…çš„common.jsé‡Œé¢ã€‚Taroæœºåˆ¶è®¤ä¸ºä¸€ä¸ªjsæ–‡ä»¶è¢«å¤šä¸ªæ¨¡å—ä¾èµ–ä¼šå°†è¯¥jsæŠ½ç¦»åˆ°common.jsã€‚è™½ç„¶æˆ‘ä»¬å…³äºEchartsç›¸å…³çš„æ–‡ä»¶éƒ½æ”¾åœ¨subpagesé‡Œé¢ï¼Œä½†æ˜¯å¦‚æœå¼•ç”¨å¤šæ¬¡è¿˜æ˜¯ä¼šæŠ½ç¦»åˆ°ä¸»åŒ…common.jsã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦ä½¿ç”¨splitChunkså°†Echartséƒ¨åˆ†å•ç‹¬æ‰“åŒ…ï¼Œç„¶åä½¿ç”¨addChunkPages å¾€é¡µé¢æ³¨å…¥ä¾èµ–ã€‚ 12345678910111213141516171819202122232425262728293031// config/index.jsmini: &#123; compile: &#123; exclude: [ // è·³è¿‡ç¼–è¯‘ path.resolve(__dirname, &#x27;..&#x27;, &#x27;src/subpages/components/ec-canvas/echarts.js&#x27;) ] &#125;, addChunkPages (pages) &#123; pages.set(&#x27;subpages/test/index&#x27;, [&#x27;subpages/common&#x27;]) &#125;, webpackChain (chain) &#123; chain.merge(&#123; optimization: &#123; splitChunks: &#123; cacheGroups: &#123; subpackagesCommon: &#123; name: &#x27;subpages/common&#x27;, minChunks: 2, test: (module,chunks) =&gt; &#123; const isNoOnlySubpackRequired = chunks.find(chunk =&gt; !(/\\bsubpages\\b/.test(chunk.name))) return !isNoOnlySubpackRequired &#125;, priority: 200 &#125; &#125; &#125; &#125; &#125;) &#125; &#125; è‡³æ­¤å¯ä»¥çœ‹åˆ°æ‰“åŒ…æ•ˆæœï¼š é¡µé¢å¼•ç”¨å‚è€ƒå‰æ–‡é¡µé¢ä½¿ç”¨ã€‚æ­¤æ—¶å¦‚æœæˆ‘ä»¬è¿è¡Œä»£ç ï¼Œå¯èƒ½ä¼šå‘ç°ä¸€ä¸ªé—®é¢˜ï¼šæ³¨æ„è¿™ä¸ªé”™è¯¯ï¼æç¤ºæ‰¾ä¸åˆ°ec-canvasç»„ä»¶ã€‚æ³¨æ„ç¼–è¯‘åçš„ç»„ä»¶ec-canvas.jså› ä¸ºä¹‹å‰æŠ½ç¦»äº†echarts.jsï¼Œç°åœ¨å·²ç»æ— æ³•å¼•å…¥ï¼Œæ‰€ä»¥éœ€è¦åœ¨ç¼–è¯‘åçš„æ–‡ä»¶ä¸­å¼•å…¥subpagesé‡Œé¢çš„common.jsã€‚ æ·»åŠ å¼•å…¥plugin(ä»£ç å¾ˆç®€å•ï¼Œå¯ä»¥å…ˆå­¦ä¹ ä¸€ä¸‹å®˜æ–¹æ–‡æ¡£å¦‚ä½•ç¼–å†™ä¸€ä¸ªæ’ä»¶) 123456789101112131415161718/* eslint-disable import/no-commonjs *//* è§£å†³chunkåŒ…æ²¡æœ‰å¼•ç”¨èµ„æºçš„é—®é¢˜**/const fs = require(&#x27;fs&#x27;);const path = require(&quot;path&quot;);module.exports.default = module.exports = (ctx, options) =&gt; &#123; ctx.onBuildFinish(() =&gt; &#123; const chunkRequireArray = options.chunkRequireArray for(let i in chunkRequireArray)&#123; const unitData = chunkRequireArray[i]; const target = path.join(ctx.paths.outputPath, unitData.fileDistPath); const data = fs.readFileSync(target, &#x27;utf8&#x27;); fs.writeFileSync(target, `$&#123;unitData.prependContent&#125;;$&#123;data&#125;`) &#125; &#125;)&#125; é…ç½®config/index.js 12345678910111213plugins: [ [ path.resolve(__dirname, &#x27;..&#x27;, &#x27;plugin/chunkCacheRequirePlugin&#x27;), &#123; chunkRequireArray:[ //å¯é…ç½®å¤šä¸ªç›®æ ‡å¼•å…¥æ–‡ä»¶ &#123; fileDistPath: &#x27;subpages/components/ec-canvas/ec-canvas.js&#x27;, prependContent: &#x27;require(&quot;../../common&quot;);&#x27; &#125; ] &#125; ] ], é‡æ–°ç¼–è¯‘å°±å¯ä»¥äº†ï¼š","categories":[{"name":"taro","slug":"taro","permalink":"https://ovyvo.github.io/yanblog.github.io/categories/taro/"}],"tags":[{"name":"å°ç¨‹åº","slug":"å°ç¨‹åº","permalink":"https://ovyvo.github.io/yanblog.github.io/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"}]},{"title":"Taroå°ç¨‹åºå¼•å…¥Echartsæ•™ç¨‹","slug":"blog3","date":"2021-10-18T00:00:00.000Z","updated":"2022-07-31T11:43:24.895Z","comments":false,"path":"2021/10/18/blog3/","link":"","permalink":"https://ovyvo.github.io/yanblog.github.io/2021/10/18/blog3/","excerpt":"","text":"å°ç¨‹åºéœ€è¦æ·»åŠ ç®€å•çš„æ•°æ®ç»Ÿè®¡åŠŸèƒ½ã€‚å› ä¸ºå¯¹Echatsæ¯”è¾ƒç†Ÿæ‚‰ï¼Œæ‰€ä»¥æƒ³å°†Echatså¼•å…¥åˆ°é¡¹ç›®ä¸­ï¼Œæœ‰å‡ ç‚¹æ³¨æ„äº‹é¡¹ï¼Œè®°å½•ä¸€ä¸‹ã€‚ taroç‰ˆæœ¬ï¼š3.3.2ï¼ˆæ³¨æ„ä¸€ä¸‹ç‰ˆæœ¬ä¿¡æ¯ï¼‰,å®˜æ–¹ç‰©æ–™ä»“åº“é‡Œé¢çš„Echartså¤§å¤šä¸å…¼å®¹æœ€æ–°ç‰ˆæœ¬taroæ¡†æ¶ï¼Œä½†æ˜¯å®ç°çš„æ€è·¯éƒ½æ˜¯ä¸€æ ·çš„ã€‚å¤§è‡´è¯´ä¸€ä¸‹ï¼š å‡†å¤‡å·¥ä½œ ä¸‹è½½Echartså®˜æ–¹çš„å°ç¨‹åºæ’ä»¶echarts-for-weixin ä¼ é€é—¨ å°†é¡¹ç›®ä¸­çš„ec-canvasæ–‡ä»¶å¤¹å¤åˆ¶ä¿å­˜ å»Echartså®˜ç½‘å®šåˆ¶å›¾è¡¨(ä¸å»ºè®®å…¨éƒ¨ä¸‹è½½ï¼Œæ–‡ä»¶å¤ªå¤§ï¼Œå°ç¨‹åºä½“ç§¯å¤§éœ€è¦åˆ†åŒ…) ä¼ é€é—¨ å‹ç¼©echarts.jsæ–‡ä»¶(å‹ç¼©æ–¹æ³•å¯ä»¥è‡ªè¡Œæ‰¾çº¿ä¸Šå‹ç¼©ç½‘ç«™æˆ–è‡ªè¡Œå‹ç¼©ï¼Œæ–¹æ³•é™„åæ–‡ï¼‰ æ›¿æ¢ec-canvasæ–‡ä»¶ä¸­çš„echarts.jsæ–‡ä»¶ æœ¬åœ°å‹ç¼©æ–¹æ³• 12npm install uglify-js -guglifyjs echarts.js -m -o echarts.min.js //æ³¨æ„ï¼šæ›¿æ¢ec-canvasé‡Œé¢çš„æ–‡ä»¶æ—¶å°†echarts.min.jsæ¢å›æ¥ å°ç¨‹åºå°è£…å›¾è¡¨ç»„ä»¶(ä»¥æŸ±çŠ¶å›¾ä¸ºä¾‹)1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465// æŸ±çŠ¶å›¾import &#123; Component &#125; from &quot;react&quot;;import &#123; View &#125; from &quot;@tarojs/components&quot;;import &#123; getCurrentInstance &#125; from &quot;@tarojs/taro&quot; //Taro3.xéœ€è¦ä½¿ç”¨getCurrentInstance è·å–é¡µé¢DOMimport &#x27;./index.scss&#x27;function setChartData(chart)&#123; const defautOption = &#123; xAxis: &#123; type: &quot;category&quot;, data: [&quot;Mon&quot;, &quot;Tue&quot;, &quot;Wed&quot;, &quot;Thu&quot;, &quot;Fri&quot;, &quot;Sat&quot;, &quot;Sun&quot;], &#125;, yAxis: &#123; type: &quot;value&quot;, &#125;, series: [ &#123; data: [120, 200, 150, 80, 70, 110, 130], type: &quot;bar&quot;, showBackground: true, backgroundStyle: &#123; color: &quot;rgba(220, 220, 220, 0.8)&quot;, &#125;, &#125;, ], &#125;; chart.setOption(defautOption);&#125;export default class BarChart extends Component &#123; constructor(props) &#123; super(props) this.state = &#123; ec: &#123; lazyLoad: true &#125; &#125; &#125; componentDidMount() &#123; &#125; refresh(data) &#123; getCurrentInstance().page.selectComponent(&#x27;#mychart-area&#x27;).init((canvas, width, height) =&gt; &#123; const chart = echarts.init(canvas, null, &#123; width: width, height: height &#125;); setChartData(chart, data); return chart; &#125;); &#125; render() &#123; return ( &lt;View className=&#x27;bar-chart&#x27;&gt; &lt;ec-canvas id=&#x27;mychart-area&#x27; canvasId=&#x27;mychart-area&#x27; ec=&#123;this.state.ec&#125; /&gt; &lt;/View&gt; ); &#125;&#125; é¡µé¢ä½¿ç”¨1234567891011121314151617181920212223242526272829303132333435363738import React, &#123; Component &#125; from &#x27;react&#x27;import &#123; View &#125; from &#x27;@tarojs/components&#x27;import BarChart from &#x27;@/components/barChart&#x27;import &#x27;./index.scss&#x27;export default class Index extends Component &#123; constructor (props) &#123; super(props) this.barChart = React.createRef() this.state = &#123; &#125; &#125; componentWillMount () &#123; &#125; componentDidMount () &#123; // å»¶è¿Ÿè°ƒç”¨ï¼Œç¡®ä¿ ec-canvas èŠ‚ç‚¹å·²å­˜åœ¨ setTimeout(() =&gt; &#123; this.barChart.current.refresh() &#125;, 100) &#125; componentWillUnmount () &#123; &#125; componentDidShow () &#123; &#125; componentDidHide () &#123; &#125; render () &#123; return ( &lt;View className=&#x27;selfstudy-container&#x27;&gt; &lt;BarChart ref=&#123;this.barChart&#125; /&gt; &lt;/View&gt; ) &#125;&#125; â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”è‡³æ­¤å›¾è¡¨å¼•å…¥å·²å®Œæˆ90%â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-ç›´æ¥é¡µé¢ä½¿ç”¨çš„è¯ä¼šæŠ¥ä¸¤ä¸ªé”™è¯¯ï¼š echarts is not definedã€‚ï¼ˆæ²¡æœ‰æ‹¿åˆ°ec-canvasé¡µé¢å®ä¾‹ï¼‰ è§£å†³æ–¹æ³•ï¼šåœ¨ app æˆ–é¡µé¢é…ç½®æ–‡ä»¶ä¸­é…ç½® usingComponents å±æ€§ã€‚ 12345678export default &#123; usingComponents: &#123; // å®šä¹‰éœ€è¦å¼•å…¥çš„ç¬¬ä¸‰æ–¹ç»„ä»¶ // 1. key å€¼æŒ‡å®šç¬¬ä¸‰æ–¹ç»„ä»¶åå­—ï¼Œä»¥å°å†™å¼€å¤´ // 2. value å€¼æŒ‡å®šç¬¬ä¸‰æ–¹ç»„ä»¶ js æ–‡ä»¶çš„ç›¸å¯¹è·¯å¾„ &#x27;ec-canvas&#x27;: &#x27;../../components/ec-canvas/ec-canvas&#x27; &#125;&#125; æ³¨æ„ï¼šTaro3 çš„ç»„ä»¶æ˜¯æ²¡æœ‰é…ç½®æ–‡ä»¶çš„ï¼Œå› æ­¤ usingComponents å¿…é¡»é…ç½®åœ¨â€œé¡µé¢â€çš„é…ç½®æ–‡ä»¶ä¸­ã€‚2. t.addEventListener is not a function è§£å†³æ–¹æ³•ï¼šåœ¨ ec-canvasæ–‡ä»¶å¤¹ä¸‹é¢çš„wx-canvas.jsæ–‡ä»¶æ·»åŠ ä»£ç ï¼š 123456789101112131415161718192021222324252627export default class WxCanvas &#123; constructor(ctx, canvasId, isNew, canvasNode) &#123; this.ctx = ctx; this.canvasId = canvasId; this.chart = null; this.isNew = isNew if (isNew) &#123; this.canvasNode = canvasNode; &#125; else &#123; this._initStyle(ctx); &#125; // this._initCanvas(zrender, ctx); this._initEvent(); &#125; // æ–°å¢ç©ºå‡½æ•°ï¼Œä¿®å¤è°ƒç”¨ echarts.init æ—¶æŠ¥é”™ addEventListener () &#123;&#125; getContext(contextType) &#123; if (contextType === &#x27;2d&#x27;) &#123; return this.ctx; &#125; &#125;&#125;","categories":[{"name":"taro","slug":"taro","permalink":"https://ovyvo.github.io/yanblog.github.io/categories/taro/"}],"tags":[{"name":"å°ç¨‹åº","slug":"å°ç¨‹åº","permalink":"https://ovyvo.github.io/yanblog.github.io/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"}]},{"title":"Taroå°ç¨‹åºåˆ†äº«","slug":"blog2","date":"2020-04-03T00:00:00.000Z","updated":"2022-07-31T11:43:24.894Z","comments":false,"path":"2020/04/03/blog2/","link":"","permalink":"https://ovyvo.github.io/yanblog.github.io/2020/04/03/blog2/","excerpt":"","text":"åœ¨å¼€å‘å°ç¨‹åºçš„æ—¶å€™é‡åˆ°è‡ªå®šä¹‰åˆ†äº«æŒ‰é’®åˆ†äº«å¡ç‰‡åˆ°å¥½å‹çš„éœ€æ±‚ï¼Œç”±äºå°ç¨‹åºçš„åˆ†äº«åªæœ‰åœ¨é¡µé¢ js ä¸­å®šä¹‰äº† onShareAppMessage(Object)æ–¹æ³•æ‰ä¼šå‡ºç°å³ä¸Šè§’çš„åˆ†äº«æŒ‰é’®,æ‰€ä»¥éœ€è¦åœ¨é¡µé¢ä¸­è‡ªå®šä¹‰åˆ†äº«æ–¹æ³•ã€‚å…·ä½“è§ä¸‹ï¼š object å‚æ•° onShareAppMessage(Object)äº‹ä»¶éœ€è¦è¿”å›ä¸€ä¸ª Object å¯¹è±¡å¯¹è±¡é‡Œé¢åŒ…å«è¦åˆ†äº«çš„æ ‡é¢˜ï¼Œè½¬å‘çš„è·¯å¾„ï¼Œä»¥åŠè‡ªå®šä¹‰å›¾ç‰‡çš„è·¯å¾„ã€‚å®Œæˆäº†è¿™ä¸€ç³»åˆ—æ“ä½œå°±å¯ä»¥æ„‰å¿«çš„å»åˆ†äº«å¾®ä¿¡å°ç¨‹åºçš„é¡µé¢äº†ã€‚ 1234567891011121314151617// åœ¨é¡µé¢ä¸­ä½¿ç”¨import Taro, &#123; Component &#125; from &quot;@tarojs/taro&quot;;import &#123; View &#125; from &quot;@tarojs/components&quot;;class index extends Component &#123; onShareAppMessage() &#123; return &#123; title: &quot;è‡ªå®šä¹‰æ ‡é¢˜&quot;, path: &quot;/page/user?id=123&quot;, // è‡ªå®šä¹‰çš„åˆ†äº«è·¯å¾„ï¼Œç‚¹å‡»åˆ†äº«çš„å¡ç‰‡ä¹‹åä¼šè·³è½¬è¿™é‡Œå®šä¹‰çš„è·¯ç”± imageUrl: &quot;&quot;, // å›¾ç‰‡è·¯å¾„ &#125;; &#125; render() &#123; return &lt;View&gt;å¾®ä¿¡åˆ†äº«&lt;/View&gt;; &#125;&#125;export default index; è‡ªå®šä¹‰åˆ†äº«æŒ‰é’®äº‹ä»¶çš„å®ç°ã€‚æœ‰æ—¶å€™ï¼Œåœ¨å¤§å¤šæ•°çš„ä¸šåŠ¡åœºæ™¯ä¸‹æˆ‘ä»¬éœ€è¦åœ¨é¡µé¢ä¸­ç‚¹å‡»æŸä¸ªæŒ‰é’®è§¦å‘åˆ†äº«çš„äº‹ä»¶ï¼Œæ­¤æ—¶éœ€è¦ç›‘å¬ç”¨æˆ·ç‚¹å‡»é¡µé¢å†…è½¬å‘æŒ‰é’®ï¼ˆButton ç»„ä»¶ openType=â€™shareâ€™ï¼‰å°±ä¼šè‡ªåŠ¨è§¦å‘ onShareAppMessage æ–¹æ³•ã€‚å¦‚æœéœ€è¦åœ¨ button ä¸­æºå¸¦ä¿¡æ¯ï¼Œéœ€è¦è‡ªå®šä¹‰ button å±æ€§ï¼Œé€šè¿‡ res.target.dataset è·å–ã€‚ 1234567891011121314151617181920212223242526272829303132// åœ¨é¡µé¢ä¸­ä½¿ç”¨import Taro, &#123; Component &#125; from &quot;@tarojs/taro&quot;;import &#123; View &#125; from &quot;@tarojs/components&quot;;class index extends Component &#123; onShareAppMessage(res) &#123; if (res.from === &quot;button&quot;) &#123; const &#123; share = &#123;&#125; &#125; = res.target.dataset; return &#123; title: `è‡ªå®šä¹‰åˆ†äº«æŒ‰é’®$&#123;share.title&#125;`, path: `/pages/bill/index`, imageUrl: &quot;&quot;, &#125;; &#125; else &#123; return &#123; title: &quot;å³ä¸Šè§’åˆ†äº«äº‹ä»¶&quot;, path: `/pages/bill/index`, imageUrl: &quot;&quot;, &#125;; &#125; &#125; render() &#123; return ( &lt;View&gt; &lt;Button open-type=&quot;share&quot; data-share=&#123;data&#125;&gt; ç‚¹å‡»åˆ†äº« &lt;/Button&gt; &lt;/View&gt; ); &#125;&#125;export default index; éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒonShareAppMessage ä¸æ”¯æŒå¼‚æ­¥è°ƒç”¨ï¼Œå¦‚æœæœ‰éœ€æ±‚æ˜¯å…ˆè¯·æ±‚æ¥å£çš„æ•°æ®å†åˆ†äº«ä¼šå› ä¸ºæ‹¿ä¸åˆ°æ•°æ®å¯¼è‡´åˆ†äº«ä¿¡æ¯ä¸æ­£ç¡®çš„é”™è¯¯ã€‚","categories":[{"name":"taro","slug":"taro","permalink":"https://ovyvo.github.io/yanblog.github.io/categories/taro/"}],"tags":[{"name":"å°ç¨‹åº","slug":"å°ç¨‹åº","permalink":"https://ovyvo.github.io/yanblog.github.io/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"}]},{"title":"vue ä½¿ç”¨é«˜å¾·åœ°å›¾ Api è·å–å½“å‰ç»çº¬åº¦ä¿¡æ¯","slug":"blog1","date":"2020-04-02T00:00:00.000Z","updated":"2022-07-31T11:43:24.894Z","comments":false,"path":"2020/04/02/blog1/","link":"","permalink":"https://ovyvo.github.io/yanblog.github.io/2020/04/02/blog1/","excerpt":"","text":"åœ¨ utils é‡Œé¢æ–°å»º getLocation.js å°è£…è·å–ç»çº¬åº¦çš„å…¬ç”¨æ–¹æ³•(ä¼˜åŒ–åŠ è½½é€Ÿåº¦åŠ¨æ€ cdn å¼•å…¥é«˜å¾·åœ°å›¾) ç”±äºé«˜å¾· Api æ–¹æ³•è·å–å½“å‰ç»çº¬åº¦æ¯”è¾ƒæ…¢ï¼Œå¦‚æœéœ€æ±‚æ˜¯åœ¨è·å–åˆ°å½“å‰ç»çº¬åº¦æ•°æ®ä¹‹åè¯·æ±‚ä¸€äº›æ•°æ®ï¼Œéœ€è¦æ­é… promise ä½¿ç”¨ä¿è¯è·å–åˆ°ç»çº¬åº¦ä¿¡æ¯ã€‚å…·ä½“è§ä¸‹é¢ä»£ç  1234567891011121314151617181920212223242526272829function loadSDK() &#123; if (window.AMap) return; return new Promise((resolve, reject) =&gt; &#123; const script = document.createElement(&quot;script&quot;); script.src = &quot;http://webapi.amap.com/maps?v=1.4.6&amp;key=*****************&quot;; //***ä¸ºç”³è¯·çš„é«˜å¾·key document.head.appendChild(script); script.onload = resolve; script.onerror = reject; &#125;);&#125;export default async () =&gt; &#123; await loadSDK(); return new Promise((resolve) =&gt; &#123; // eslint-disable-next-line no-undef AMap.plugin(&quot;AMap.Geolocation&quot;, () =&gt; &#123; // eslint-disable-next-line no-undef const geolocation = new AMap.Geolocation(&#123; enableHighAccuracy: false &#125;); geolocation.getCurrentPosition((status, result) =&gt; &#123; const res = status === &quot;complete&quot; ? result.position : &#123; lat: 39.909187, lng: 116.397451 &#125;; //é»˜è®¤åŒ—äº¬ 116.397451ã€39.909187 console.log(&quot;å®šä½ç»“æœ&quot;, res); resolve(res); &#125;); &#125;); &#125;);&#125;; åœ¨ vue é¡µé¢ä¸­çš„ä½¿ç”¨ï¼ˆè¿™é‡Œå‡è®¾éœ€æ±‚æ˜¯è¯·æ±‚ç¦»æˆ‘æœ€è¿‘åº—é“ºä¿¡æ¯åˆ—è¡¨ï¼‰ 12345678910111213141516171819202122232425262728293031323334353637383940&lt;template&gt; &lt;div class=&quot;main-container&quot;&gt; &lt;div class=&quot;list&quot;&gt; &lt;div class=&quot;list-item&quot; v-for=&quot;(item,index) in list&quot; :key=&quot;index&quot;&gt; //you can do something &lt;/div&gt; &lt;/div&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;import * as Api from &#x27;@/api/xxx.js&#x27; //å¼•å…¥è¯·æ±‚æ¥å£çš„Apiimport getLocation from &#x27;@/utils/getLocation&#x27; //å¼•å…¥getLocationæ–¹æ³•export default &#123; data() &#123; return &#123; params: &#123;&#125;, list: [] &#125; &#125;, mounted() &#123; this.fetchList() &#125;, methods: &#123; async getPosition() &#123; const &#123; lng, lat &#125; = await getLocation() this.params = &#123; lng, lat &#125; &#125;, async fetchList() &#123; await this.getPosition() const &#123; list &#125; = await Api.fetchList(this.params) this.list = list &#125; &#125;&#125;&lt;/script&gt;&lt;style lang=&#x27;less&#x27; scoped&gt;&lt;/style&gt; æ³¨æ„å¦‚æœåœ¨ index.html ä¸­å¼•å…¥é«˜å¾·åœ°å›¾åœ¨å…¨å±€ä½¿ç”¨ AMap æ„é€ å‡½æ•°éœ€è¦åœ¨ vue.config.js æ·»åŠ å¦‚ä¸‹é…ç½®,å¦åˆ™ä¼šæŠ¥â€˜AMap is not definedâ€™é”™è¯¯ 1234567module.exports = &#123; configureWebpack: &#123; externals: &#123; AMap: &quot;AMap&quot;, &#125;, &#125;,&#125;; åœ¨é¡µé¢ä¸­ä½¿ç”¨ï¼ˆä¸¾ä¸ª ğŸŒ°ï¼Œä»£ç æœªæµ‹è¯•ï¼‰ 12345678910111213141516171819&lt;script&gt;import AMap from &#x27;AMap&#x27;export default&#123; methods:&#123; fn()&#123; AMap.plugin(&#x27;AMap.Geolocation&#x27;, () =&gt; &#123; const geolocation = new AMap.Geolocation(&#123; enableHighAccuracy: false &#125;) geolocation.getCurrentPosition((status, result) =&gt; &#123; const res = status === &#x27;complete&#x27; ? result.position : &#123; lat: 39.909187, lng: 116.397451 &#125; //é»˜è®¤åŒ—äº¬ 116.397451ã€39.909187 console.log(&#x27;å®šä½ç»“æœ&#x27;, res) &#125;) &#125;) &#125; &#125;&#125;&lt;/script&gt;","categories":[{"name":"vue","slug":"vue","permalink":"https://ovyvo.github.io/yanblog.github.io/categories/vue/"}],"tags":[{"name":"å·¥å…·","slug":"å·¥å…·","permalink":"https://ovyvo.github.io/yanblog.github.io/tags/%E5%B7%A5%E5%85%B7/"}]}],"categories":[{"name":"vue","slug":"vue","permalink":"https://ovyvo.github.io/yanblog.github.io/categories/vue/"},{"name":"taro","slug":"taro","permalink":"https://ovyvo.github.io/yanblog.github.io/categories/taro/"}],"tags":[{"name":"vue-3","slug":"vue-3","permalink":"https://ovyvo.github.io/yanblog.github.io/tags/vue-3/"},{"name":"å°ç¨‹åº","slug":"å°ç¨‹åº","permalink":"https://ovyvo.github.io/yanblog.github.io/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"},{"name":"å·¥å…·","slug":"å·¥å…·","permalink":"https://ovyvo.github.io/yanblog.github.io/tags/%E5%B7%A5%E5%85%B7/"}]}